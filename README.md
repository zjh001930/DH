
# ğŸ¤– AI åŠ©æ‰‹å·¥å…·

ä¸€ä¸ªåŸºäº Docker çš„æ™ºèƒ½åŠ©æ‰‹ç³»ç»Ÿï¼Œé›†æˆäº†å¤§è¯­è¨€æ¨¡å‹(LLM)ã€å‘é‡æ•°æ®åº“å’ŒçŸ¥è¯†æ£€ç´¢åŠŸèƒ½ï¼Œä¸ºç”¨æˆ·æä¾›æ™ºèƒ½é—®ç­”å’Œä»»åŠ¡å¼•å¯¼æœåŠ¡ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ§  **æ™ºèƒ½é—®ç­”**: åŸºäº RAG (æ£€ç´¢å¢å¼ºç”Ÿæˆ) çš„çŸ¥è¯†é—®ç­”ç³»ç»Ÿ
- ğŸ“‹ **ä»»åŠ¡å¼•å¯¼**: ç»“æ„åŒ–çš„æ“ä½œæ­¥éª¤æŒ‡å¯¼ï¼Œæ”¯æŒå›¾ç‰‡å±•ç¤º
- ğŸ” **æ„å›¾è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«ç”¨æˆ·æ„å›¾ï¼Œæ™ºèƒ½è·¯ç”±åˆ°ç›¸åº”åŠŸèƒ½
- ğŸ’¬ **å¯¹è¯ç•Œé¢**: ç°ä»£åŒ–çš„ Web èŠå¤©ç•Œé¢
- ğŸ³ **å®¹å™¨åŒ–éƒ¨ç½²**: å®Œå…¨åŸºäº Docker çš„ä¸€é”®éƒ¨ç½²
- ğŸ”„ **å®æ—¶å“åº”**: æ”¯æŒæµå¼å¯¹è¯å’Œå®æ—¶çŠ¶æ€æ›´æ–°

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ (React)   â”‚â”€â”€â”€â”€â”‚   åç«¯ (Flask)   â”‚â”€â”€â”€â”€â”‚  Ollama (LLM)   â”‚
â”‚   ç«¯å£: 3000    â”‚    â”‚   ç«¯å£: 8000    â”‚    â”‚   ç«¯å£: 11434   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                   â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ PostgreSQL    â”‚   â”‚   Weaviate    â”‚
            â”‚ (ä»»åŠ¡æ•°æ®)     â”‚   â”‚  (å‘é‡æ•°æ®åº“)  â”‚
            â”‚ ç«¯å£: 5432    â”‚   â”‚  ç«¯å£: 8080   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

- **å‰ç«¯**: React + ç°ä»£åŒ– UIï¼Œæä¾›èŠå¤©ç•Œé¢å’Œä»»åŠ¡å±•ç¤º
- **åç«¯**: Flask APIï¼Œå¤„ç†æ„å›¾è¯†åˆ«ã€ä»»åŠ¡è·¯ç”±å’Œæ•°æ®ç®¡ç†
- **Ollama**: æœ¬åœ° LLM æœåŠ¡ï¼Œæ”¯æŒ Llama3 å’Œ BGE-M3 æ¨¡å‹
- **PostgreSQL**: å­˜å‚¨ä»»åŠ¡æ•°æ®ã€æ­¥éª¤ä¿¡æ¯å’Œç”¨æˆ·ç•Œé¢å…ƒç´ 
- **Weaviate**: å‘é‡æ•°æ®åº“ï¼Œæ”¯æŒè¯­ä¹‰æœç´¢å’Œ RAG åŠŸèƒ½

## ğŸ“‹ ç›®å½•

- [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [ä½¿ç”¨æŒ‡å—](#-ä½¿ç”¨æŒ‡å—)
- [å¼€å‘æŒ‡å—](#-å¼€å‘æŒ‡å—)
- [æ•°æ®åº“æ“ä½œ](#-æ•°æ®åº“æ“ä½œ)
- [æµ‹è¯•éªŒè¯](#-æµ‹è¯•éªŒè¯)
- [API æ¥å£](#-api-æ¥å£)
- [é…ç½®è¯´æ˜](#ï¸-é…ç½®è¯´æ˜)
- [é«˜çº§ç”¨æ³•](#-é«˜çº§ç”¨æ³•)
- [æ•…éšœæ’é™¤](#-æ•…éšœæ’é™¤)
- [è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç³»ç»Ÿè¦æ±‚

- Docker å’Œ Docker Compose
- è‡³å°‘ 8GB å†…å­˜ (æ¨è 16GB)
- 10GB å¯ç”¨ç£ç›˜ç©ºé—´

### ä¸€é”®éƒ¨ç½²

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd ai_assistant_tool
```

2. **å¯åŠ¨æ‰€æœ‰æœåŠ¡**
```bash
docker-compose up -d
```

3. **ç­‰å¾…æœåŠ¡åˆå§‹åŒ–** (é¦–æ¬¡å¯åŠ¨çº¦éœ€ 5-10 åˆ†é’Ÿ)
```bash
# æŸ¥çœ‹å¯åŠ¨çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

4. **ä¸‹è½½ AI æ¨¡å‹**
```bash
# ä¸‹è½½ Qwen2.5 æ¨¡å‹ (ç”¨äºå¯¹è¯ç”Ÿæˆ)
docker exec -it ollama_host ollama pull qwen2.5:3b-instruct

# ä¸‹è½½ BGE-M3 æ¨¡å‹ (ç”¨äºå‘é‡åŒ–)
docker exec -it ollama_host ollama pull bge-m3
```

5. **å¯¼å…¥åˆå§‹æ•°æ®**
```cmd
run_data_import.bat
```

### ä¸€é”®å¯åŠ¨ï¼ˆWindowsï¼Œä¸€è¡Œå‘½ä»¤ï¼‰
åœ¨å®‰è£…å¹¶å¯åŠ¨ Docker Desktop åï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œè¿™ä¸€è¡Œå‘½ä»¤å³å¯å®Œæˆæ„å»ºã€å¯åŠ¨ã€æ‹‰æ¨¡å‹ä¸å¯¼å…¥æ•°æ®ï¼š
```bash
docker-compose up -d --build && timeout /t 30 /nobreak >nul && docker exec -i ollama_host ollama pull qwen2.5:3b-instruct && docker exec -i ollama_host ollama pull bge-m3 && docker exec -i ai_assistant_backend python ingest_data_simple.py
```

è¯´æ˜ï¼š
- æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆå‰ç«¯ã€åç«¯ã€Ollamaã€Postgresã€Weaviateï¼‰
- ç­‰å¾…æœåŠ¡å°±ç»ªçº¦ 30 ç§’ï¼ˆé¦–æ¬¡å¯åŠ¨è€—æ—¶æ›´é•¿ï¼‰
- æ‹‰å–å¯¹è¯ä¸å‘é‡æ¨¡å‹ï¼ˆ`qwen2.5:3b-instruct` ä¸ `bge-m3`ï¼‰
- åœ¨åç«¯å®¹å™¨å†…å¯¼å…¥åˆå§‹æ•°æ®ï¼ˆé¿å…å®¿ä¸»ç¯å¢ƒå·®å¼‚ï¼‰

æˆåŠŸåè®¿é—®ï¼š
- å‰ç«¯ç•Œé¢: `http://localhost:3000`
- åç«¯ API: `http://localhost:8000`
- Weaviate æ§åˆ¶å°: `http://localhost:8080`

### å¸¸ç”¨ Docker å‘½ä»¤
- æ„å»ºé•œåƒï¼š
```bash
docker-compose build
```
- å¯åŠ¨æœåŠ¡ï¼š
```bash
docker-compose up -d
```
- æŸ¥çœ‹çŠ¶æ€ï¼š
```bash
docker-compose ps
```
- æŸ¥çœ‹æŸæœåŠ¡æ—¥å¿—ï¼š
```bash
docker-compose logs -f backend
```
### åŸºæœ¬å¯¹è¯

åœ¨å‰ç«¯ç•Œé¢ä¸­ï¼Œä½ å¯ä»¥ï¼š

1. **æé—®çŸ¥è¯†ç›¸å…³é—®é¢˜**
   - "å¦‚ä½•å®‰è£…è½¯ä»¶ï¼Ÿ"
   - "æ•°æ®é‡‡é›†çš„æ­¥éª¤æ˜¯ä»€ä¹ˆï¼Ÿ"
   - "FFTåˆ†ææ€ä¹ˆåšï¼Ÿ"

2. **è¯·æ±‚ä»»åŠ¡æŒ‡å¯¼**
   - "è¯·ç»™æˆ‘ä»é‡‡é›†åˆ°FFTåˆ†æçš„å…¨æµç¨‹"
   - "æˆ‘æƒ³è¿›è¡Œæ•°æ®åˆ†æ"

### API ä½¿ç”¨

```bash
# å‘é€é—®é¢˜åˆ° AI åŠ©æ‰‹
curl -X POST http://localhost:8000/assistant \
  -H "Content-Type: application/json" \
  -d '{"user_input": "å¦‚ä½•è¿›è¡ŒFFTåˆ†æï¼Ÿ"}'

# è·å–å¯ç”¨ä»»åŠ¡åˆ—è¡¨
curl http://localhost:8000/tasks
```

### å“åº”ç±»å‹

ç³»ç»Ÿæ”¯æŒä¸¤ç§å“åº”ç±»å‹ï¼š

1. **ä»»åŠ¡æ‰§è¡Œ** (`task_execution`): è¿”å›ç»“æ„åŒ–çš„æ“ä½œæ­¥éª¤
2. **å¼€æ”¾é—®ç­”** (`open_qa`): è¿”å›åŸºäºçŸ¥è¯†åº“çš„æ–‡æœ¬å›ç­”

## ğŸ”§ å¼€å‘æŒ‡å—

### ç¯å¢ƒé…ç½®

1. **å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶**
```bash
cp .env.example .env
```

2. **ä¿®æ”¹é…ç½®** (å¯é€‰)
```bash
POSTGRES_PORT=5432
WEAVIATE_PORT=8080
OLLAMA_PORT=11434
```

#### Weaviate è¿æ¥ä¸å›é€€é€»è¾‘
- `.env` é»˜è®¤ï¼š`WEAVIATE_HOST=weaviate:8080`ï¼Œç”¨äºå®¹å™¨é—´é€šä¿¡ã€‚
- å¦‚æœåœ¨å®¿ä¸»æœºç›´æ¥è¿è¡Œ Python è„šæœ¬ï¼ˆå¦‚ `ingest_data.py`ï¼‰ï¼Œ`weaviate` åŸŸåä¸ä¼šè¢«å®¿ä¸»æœºè§£æã€‚
- ä¸ºå…¼å®¹æœ¬åœ°è¿è¡Œï¼Œ`backend/db/vector_repo.py` å¢åŠ äº† HTTP å›é€€æœºåˆ¶ï¼š
  - å½“å®¢æˆ·ç«¯ä¸å¯ç”¨æˆ–è¿æ¥å¤±è´¥æ—¶ï¼Œä¼šè‡ªåŠ¨å°è¯• `http://localhost:<ç«¯å£>`ã€‚
  - åªè¦ Docker æ˜ å°„äº† Weaviate çš„ `8080` åˆ°å®¿ä¸»æœºï¼Œå¯¼å…¥å’Œç»Ÿè®¡ç­‰ HTTP æ“ä½œå°†æ­£å¸¸å·¥ä½œã€‚
- ä½ ä¹Ÿå¯ä»¥åœ¨æœ¬åœ°åœºæ™¯ä¸‹ï¼Œå°† `.env` æˆ– `.env.local` çš„ `WEAVIATE_HOST` æ”¹ä¸ºï¼š
```plaintext
WEAVIATE_HOST=localhost:8080
```
### åç«¯å¼€å‘

1. **å®‰è£… Python ä¾èµ–**
```bash
cd backend
pip install -r requirements.txt
```

2. **é…ç½®æ•°æ®åº“è¿æ¥**
```bash
# ç¡®ä¿ PostgreSQL å’Œ Weaviate æœåŠ¡è¿è¡Œ
docker-compose up -d postgres_db weaviate
```

3. **æœ¬åœ°è¿è¡Œåç«¯**
```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export FLASK_ENV=development
export FLASK_DEBUG=1

# å¯åŠ¨åç«¯æœåŠ¡
python app.py
```

4. **å¯¼å…¥æµ‹è¯•æ•°æ®**
```bash
python ingest_data_simple.py
```

### å‰ç«¯å¼€å‘

1. **å®‰è£… Node.js ä¾èµ–**
```bash
cd frontend
npm install
```

2. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
```bash
npm start
```

3. **æ„å»ºç”Ÿäº§ç‰ˆæœ¬**
```bash
npm run build
```

### è°ƒè¯•æŒ‡å—

1. **æŸ¥çœ‹åç«¯æ—¥å¿—**
```bash
# å®¹å™¨æ¨¡å¼
docker-compose logs -f backend

# æœ¬åœ°å¼€å‘æ¨¡å¼
tail -f backend/app.log
```

2. **æµ‹è¯• API ç«¯ç‚¹**
```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8000/health

# æµ‹è¯•åŠ©æ‰‹æ¥å£
curl -X POST http://localhost:8000/assistant \
  -H "Content-Type: application/json" \
  -d '{"user_input": "æµ‹è¯•æ¶ˆæ¯"}'
```

3. **æ•°æ®åº“è°ƒè¯•**
```bash
# è¿æ¥ PostgreSQL
docker exec -it postgres_db psql -U assistant_user -d assistant_db

# æŸ¥çœ‹è¡¨ç»“æ„
\d tasks
\d task_steps
\d ui_elements
```

### æ•°æ®åº“æ“ä½œ

è¿æ¥ PostgreSQL æ•°æ®åº“ï¼š
```bash
docker exec -it postgres_db psql -U assistant_user -d assistant_db
```

æŸ¥çœ‹æ•°æ®è¡¨ï¼š
```sql
\dt
SELECT COUNT(*) FROM tasks;
SELECT COUNT(*) FROM task_steps;
SELECT COUNT(*) FROM ui_elements;
```

## ğŸ§ª æµ‹è¯•éªŒè¯

### 1. åŠŸèƒ½æµ‹è¯•

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯å„é¡¹åŠŸèƒ½ï¼š

**Windows:**
```cmd
test_data_import.bat
```

**æ‰‹åŠ¨æµ‹è¯•:**
```bash
# æµ‹è¯•çŸ¥è¯†é—®ç­”
curl -X POST http://localhost:8000/assistant \
  -H "Content-Type: application/json" \
  -d '{"query": "å¦‚ä½•å®‰è£…è½¯ä»¶ï¼Ÿ", "conversation_id": "test"}'

# æµ‹è¯•ä»»åŠ¡å¼•å¯¼
curl -X POST http://localhost:8000/assistant \
  -H "Content-Type: application/json" \
  -d '{"query": "æˆ‘æƒ³è¿›è¡ŒFFTåˆ†æ", "conversation_id": "test"}'
```

### 2. å¥åº·æ£€æŸ¥

æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€ï¼š
```bash
docker-compose ps
```

æŸ¥çœ‹æœåŠ¡æ—¥å¿—ï¼š
```bash
docker-compose logs -f [service-name]
```

## ğŸ” API æ¥å£

### ä¸»è¦ç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | æè¿° |
|------|------|------|
| `/assistant` | POST | æ™ºèƒ½åŠ©æ‰‹å¯¹è¯æ¥å£ |
| `/tasks` | GET | è·å–ä»»åŠ¡åˆ—è¡¨ |
| `/tasks/screenshots/<filename>` | GET | è·å–ä»»åŠ¡æˆªå›¾ |

### è¯·æ±‚ç¤ºä¾‹

```json
POST /assistant
{
  "query": "ç”¨æˆ·é—®é¢˜æˆ–æŒ‡ä»¤",
  "conversation_id": "ä¼šè¯ID"
}
```

### å“åº”ç¤ºä¾‹

```json
{
  "response": "åŠ©æ‰‹å›å¤å†…å®¹",
  "intent": "è¯†åˆ«çš„æ„å›¾ç±»å‹",
  "confidence": 0.85,
  "conversation_id": "ä¼šè¯ID"
}
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å®¹å™¨å¯åŠ¨å¤±è´¥**
   - æ£€æŸ¥ Docker æœåŠ¡æ˜¯å¦è¿è¡Œ
   - ç¡®è®¤ç«¯å£æœªè¢«å ç”¨
   - æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š`docker-compose logs`

2. **æ•°æ®å¯¼å…¥å¤±è´¥**
   - ç¡®è®¤ PostgreSQL å®¹å™¨æ­£å¸¸è¿è¡Œ
   - æ£€æŸ¥æ•°æ®æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   - æŸ¥çœ‹å¯¼å…¥æ—¥å¿—ï¼š`backend/ingest_data_simple.log`

3. **LLM å“åº”å¼‚å¸¸**
   - ç¡®è®¤ Ollama å®¹å™¨æ­£å¸¸è¿è¡Œ
   - æ£€æŸ¥æ¨¡å‹æ˜¯å¦å·²ä¸‹è½½
   - éªŒè¯ API è¿æ¥ï¼š`curl http://localhost:11434/api/tags`

4. **RAG åŠŸèƒ½å¼‚å¸¸**
   - ç¡®è®¤ Weaviate å®¹å™¨æ­£å¸¸è¿è¡Œ
   - æ£€æŸ¥å‘é‡æ•°æ®æ˜¯å¦å·²å¯¼å…¥
   - è®¿é—® Weaviate æ§åˆ¶å°ï¼šhttp://localhost:8080

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs ollama
docker-compose logs weaviate
docker-compose logs postgres_db

# æŸ¥çœ‹åç«¯åº”ç”¨æ—¥å¿—
docker-compose logs api-layer
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼š`git checkout -b feature/new-feature`
3. æäº¤æ›´æ”¹ï¼š`git commit -am 'Add new feature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/new-feature`
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š

1. æŸ¥çœ‹ [æ•…éšœæ’é™¤](#-æ•…éšœæ’é™¤) éƒ¨åˆ†
2. åˆ›å»º [Issue](../../issues)
3. è”ç³»é¡¹ç›®ç»´æŠ¤è€…

---

**æ³¨æ„**: é¦–æ¬¡å¯åŠ¨å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ä¸‹è½½ Docker é•œåƒå’Œ LLM æ¨¡å‹ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚

5. **Python æŠ¥é”™ï¼šcannot import name '__version__' (weaviate-client)**
- ç°è±¡ï¼šè¿è¡Œ `python ingest_data.py` æ—¶ï¼Œæ—¥å¿—å‡ºç° `cannot import name '__version__'`ã€‚
- åŸå› ï¼š`weaviate-client` çš„ç‰ˆæœ¬ä¸å½“å‰ Python ç¯å¢ƒä¸å…¼å®¹æˆ–åŒ…æŸåã€‚
- è§£å†³ï¼š
```cmd
python -m pip install --upgrade --force-reinstall weaviate-client
```
- å¦‚ä»å¤±è´¥ï¼Œå»ºè®®åœ¨è™šæ‹Ÿç¯å¢ƒä¸­é‡æ–°å®‰è£…ä¾èµ–ï¼Œæˆ–å°† `WEAVIATE_HOST` è®¾ä¸º `localhost:8080`ï¼Œä¾èµ– HTTP å›é€€å®Œæˆå¯¼å…¥ã€‚
